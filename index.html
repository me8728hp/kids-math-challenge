<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, orientation=landscape">
    <title>„Ç≠„ÉÉ„Ç∫ÁÆóÊï∞„Ç¢„Éâ„Éô„É≥„ÉÅ„É£„Éº</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#00BCD4">

    <!-- iOS PWA Settings -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="assets/icon-192.png">
    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü¶Å</text></svg>">
</head>

<body>

    <!-- „Ç¢„Éó„É™ÂÖ®‰Ωì„ÅÆ„Ç≥„É≥„ÉÜ„Éä -->
    <div id="app-container">

        <!-- === 0. Âêë„ÅçË≠¶ÂëäÁîªÈù¢ („Çπ„Éû„ÉõÁ∏¶ÊåÅ„Å°Èò≤Ê≠¢) === -->
        <div id="orientation-warning">
            <div class="message-box">
                <h1>„Çà„Åì„ÇÄ„Åç„Å´„Åó„Å¶„Å≠ÔºÅ</h1>
                <div class="rotate-icon">üì± ‚û°Ô∏è üìü</div>
            </div>
        </div>

        <!-- === 1. „É¶„Éº„Ç∂„ÉºÁôªÈå≤ÁîªÈù¢ === -->
        <section id="registration-view" class="view hidden">
            <div class="content-wrapper centered">
                <h1 class="main-title">„Ç≠„ÉÉ„Ç∫„Åï„Çì„Åô„ÅÜ„Ç¢„Éâ„Éô„É≥„ÉÅ„É£„Éº</h1>
                <h2 class="sub-title">„Åä„Å™„Åæ„Åà„Çí„Åä„Åó„Åà„Å¶„Å≠</h2>

                <!-- Returning User Area -->
                <div id="returning-user-area" class="hidden">
                    <div id="user-list-container">
                        <!-- Users will be rendered here -->
                    </div>
                    <button id="add-new-user-btn" class="main-action-btn" style="margin-top: 20px;">
                        ‚ûï „ÅÇ„Åü„Çâ„Åó„ÅÑ „Åä„Å®„ÇÇ„Å†„Å°
                    </button>
                </div>

                <!-- Registration Area -->
                <div id="registration-area">
                    <button id="reg-back-btn" class="secondary-btn hidden" style="margin-bottom: 10px;">‚Ü©Ô∏è „ÇÇ„Å©„Çã</button>
                    <div class="input-group">
                        <label>„Åä„Å™„Åæ„Åà („Å≤„Çâ„Åå„Å™)</label>
                        <input type="text" id="user-name-input" placeholder="‰æã: „Åü„Çç„ÅÜ" autocomplete="off">
                    </div>
                    <div class="input-group">
                        <label>„Å™„Çì„Åï„ÅÑÔºü</label>
                        <div class="age-selector">
                            <button class="age-btn" data-age="3">3„Åï„ÅÑ</button>
                            <button class="age-btn" data-age="4">4„Åï„ÅÑ</button>
                            <button class="age-btn" data-age="5">5„Åï„ÅÑ</button>
                            <button class="age-btn" data-age="6">6„Åï„ÅÑ</button>
                        </div>
                    </div>
                    <button id="start-btn" class="main-action-btn disabled">„ÅØ„Åò„ÇÅ„ÇãÔºÅ</button>
                </div>

                <div style="margin-top: 40px; text-align: center;">
                    <button id="update-app-btn" class="secondary-btn"
                        style="font-size: 0.8rem; padding: 5px 15px; opacity: 0.7;">
                        üîÑ „Ç¢„Éó„É™„ÅÆ„Åì„ÅÜ„Åó„Çì
                    </button>
                </div>
                <div id="app-version">v1.1.0</div>
            </div>
        </section>

        <!-- === 2. „Éû„ÉÉ„ÉóÁîªÈù¢ („É¨„Éô„É´ÈÅ∏Êäû) === -->
        <section id="map-view" class="view hidden">
            <header class="map-header">
                <div class="user-info">
                    <span id="display-user-name">„Ç≤„Çπ„Éà</span> „Åè„Çì/„Å°„ÇÉ„Çì
                </div>
                <button id="title-back-btn" class="secondary-btn"
                    style="font-size: 1rem; padding: 0.5rem 1rem;">„Çø„Ç§„Éà„É´„Å∏„ÇÇ„Å©„Çã</button>
            </header>
            <div class="map-container-scroll">
                <div class="map-path">
                    <!-- „É¨„Éô„É´„Éú„Çø„É≥„ÅØJS„ÅßÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                    <!-- ‰æã: <button class="level-node unlocked" data-level="1">1</button> -->
                    <svg class="path-line" width="100%" height="100%"></svg>
                </div>
            </div>
        </section>

        <!-- === 3. „Ç≤„Éº„É†„Éó„É¨„Ç§ÁîªÈù¢ === -->
        <section id="game-view" class="view hidden">
            <header class="game-header">
                <button id="back-to-map-btn" class="icon-btn">‚Ü©Ô∏è „ÇÇ„Å©„Çã</button>
                <div class="progress-bar-container">
                    <div id="game-progress-bar" class="progress-fill" style="width: 0%;"></div>
                </div>
                <div id="game-progress-text"
                    style="font-size: 1.2rem; font-weight: bold; color: var(--text-color); margin-left: 10px;">1/10
                </div>
            </header>

            <main class="game-area">
                <div id="question-area" class="question-container">
                    <div id="question-text">„ÇÇ„Çì„Å†„ÅÑ</div>
                    <div id="question-visuals">
                        <!-- ÁîªÂÉè„ÇÑ„Éâ„ÉÉ„Éà„Å™„Å© -->
                    </div>
                </div>

                <div id="options-area" class="options-container">
                    <!-- ÈÅ∏ÊäûËÇ¢„Éú„Çø„É≥„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô -->
                </div>

                <button id="hint-btn" class="hint-btn hidden">üí° „Éí„É≥„Éà</button>
            </main>

            <!-- „Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ„Ç™„Éº„Éê„Éº„É¨„Ç§ (Ê≠£Ëß£/‰∏çÊ≠£Ëß£) -->
            <div id="feedback-overlay" class="overlay hidden">
                <div class="feedback-content">
                    <div id="feedback-icon">üåü</div>
                    <div id="feedback-text">„Åô„Åî„ÅÑÔºÅ</div>
                </div>
            </div>
        </section>

        <!-- === 4. „É™„Ç∂„É´„ÉàÁîªÈù¢ === -->
        <section id="result-view" class="view hidden">
            <div class="content-wrapper centered">
                <h1>„Åä„Å§„Åã„Çå„Åï„ÅæÔºÅ</h1>

                <div class="score-display">
                    <div class="stars-container" id="result-stars">
                        <!-- Êòü„Åå„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÅßÂÖ•„Çã -->
                    </div>
                    <p id="result-message">„Çà„Åè„Åå„Çì„Å∞„Å£„Åü„Å≠ÔºÅ</p>
                </div>

                <div class="action-buttons">
                    <button id="retry-btn" class="secondary-btn">„ÇÇ„ÅÜ„ÅÑ„Å°„Å©</button>
                    <button id="next-level-btn" class="main-action-btn">„Å§„Åé„Å∏„Åô„Åô„ÇÄ</button>
                    <button id="return-map-btn" class="secondary-btn">„Éû„ÉÉ„Éó„Å´„ÇÇ„Å©„Çã</button>
                </div>
            </div>
        </section>

    </div>

    <!-- Èü≥Â£∞„Éï„Ç°„Ç§„É´ („Éó„É¨„Éº„Çπ„Éõ„É´„ÉÄ„ÉºË™≠„ÅøËæº„Åø) -->
    <audio id="bgm-main" loop src="assets/bgm_placeholder.mp3"></audio>

    <script src="script.js"></script>
    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('SW registered!', reg))
                    .catch(err => console.log('SW failed', err));
            });
        }
    </script>


</body>

</html>